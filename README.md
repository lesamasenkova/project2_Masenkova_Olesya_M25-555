# Примитивная база данных

Primitive database management system - консольное приложение для управления примитивной базой данных с поддержкой CRUD-операций.

## Возможности

- ✅ Создание, удаление и управление таблицами
- ✅ CRUD-операции (Insert, Select, Update, Delete)
- ✅ Фильтрация данных по условиям
- ✅ Красивый вывод таблиц (PrettyTable)
- ✅ Подтверждение опасных операций
- ✅ Логирование времени выполнения операций
- ✅ Обработка ошибок и валидация данных
- ✅ Кэширование результатов SELECT запросов
- ✅ JSON-персистентность данных

## Установка

Клонирование репозитория
git clone https://github.com/lesamasenkova/project2_Masenkova_Olesya_M25-555.git
cd project2_Masenkova_Olesya_M25-555

Установка зависимостей
make install


## Запуск

Запуск через make
make project

Или напрямую через poetry
poetry run project

## Управление таблицами

### Команды создания и удаления таблиц

- `create_table <имя_таблицы> <столбец1:тип> <столбец2:тип> ...` - создать таблицу
- `list_tables` - показать список всех таблиц
- `drop_table <имя_таблицы>` - удалить таблицу (требует подтверждения)

### Поддерживаемые типы данных

- `int` - целое число
- `str` - строка
- `bool` - логическое значение

### Пример

create_table users name:str age:int is_active:bool
Таблица "users" успешно создана со столбцами: ID:int, name:str, age:int, is_active:bool

list_tables

users


## CRUD-операции

### Доступные команды

- `insert into <имя_таблицы> values (<значение1>, <значение2>, ...)` - добавить запись
- `select from <имя_таблицы>` - показать все записи
- `select from <имя_таблицы> where <столбец> = <значение>` - показать записи по условию
- `update <имя_таблицы> set <столбец> = <значение> where <столбец> = <значение>` - обновить записи
- `delete from <имя_таблицы> where <столбец> = <значение>` - удалить записи (требует подтверждения)
- `info <имя_таблицы>` - показать информацию о таблице
- `help` - справочная информация
- `exit` - выход из программы

### Примеры использования

insert into users values ("Sergei", 28, true)
Запись с ID=1 успешно добавлена в таблицу "users".
Функция insert выполнилась за 0.001 секунд.

select from users
+----+--------+-----+-----------+
| ID | name | age | is_active |
+----+--------+-----+-----------+
| 1 | Sergei | 28 | True |
+----+--------+-----+-----------+
Функция select выполнилась за 0.001 секунд.

select from users where age = 28
+----+--------+-----+-----------+
| ID | name | age | is_active |
+----+--------+-----+-----------+
| 1 | Sergei | 28 | True |
+----+--------+-----+-----------+

update users set age = 29 where name = "Sergei"
Запись с ID=1 в таблице "users" успешно обновлена.

delete from users where ID = 1
Вы уверены, что хотите выполнить "удаление записи"? [y/n]: y
Запись с ID=1 успешно удалена из таблицы "users".

drop_table users
Вы уверены, что хотите выполнить "удаление таблицы"? [y/n]: n
Операция отменена.

info users
Таблица: users
Столбцы: ID:int, name:str, age:int, is_active:bool
Количество записей: 0

## Демонстрация работы в Aciinema
https://asciinema.org/a/YDrOXuBjS94mCSemZBXLRMAoL

## Продвинутые возможности

### Декораторы и обработка ошибок

Система использует декораторы для:
- **Обработки ошибок** - автоматическое перехватывание и логирование ошибок
- **Подтверждения действий** - запрос подтверждения для опасных операций (удаление)
- **Логирования времени** - измерение и вывод времени выполнения операций
- **Кэширования** - сохранение результатов SELECT запросов для повышения производительности

### Замыкания

Функция `create_cacher()` использует замыкание для создания приватного кэша, который не видим извне, но доступен функции `cache_result()`.

## Сборка и публикация

Сборка пакета
make build

Отладка публикации
make publish

Установка пакета в систему
make package-install


## Проверка качества кода

make lint

## Структура проекта

project2_Masenkova_Olesya_M25-555/
├── data/ # Данные таблиц (.json файлы)
├── src/
│ ├── decorators.py # Декораторы (обработка ошибок, логирование)
│ └── primitive_db/
│ ├── core.py # Логика CRUD операций
│ ├── engine.py # Главный цикл и парсинг команд
│ ├── main.py # Точка входа
│ ├── parser.py # Парсеры SQL-like команд
│ └── utils.py # Работа с файлами
├── db_meta.json # Метаданные таблиц
├── Makefile
└── pyproject.toml
